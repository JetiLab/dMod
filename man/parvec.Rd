% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/classes.R, R/parClass.R
\name{parvec}
\alias{parvec}
\alias{as.parvec}
\alias{as.parvec.numeric}
\title{Parameter vector}
\usage{
parvec(..., deriv = NULL, deriv2 = NULL)

as.parvec(x, ...)

\method{as.parvec}{numeric}(x, names = NULL, deriv = NULL, ...)
}
\arguments{
\item{...}{Objects to be concatenated.}

\item{deriv}{Optional Jacobian matrix (first derivatives), \code{FALSE} to drop,
or \code{NULL} to inherit if present attribute 'deriv'.}

\item{deriv2}{Optional Hessian array (second derivatives), \code{FALSE} to drop,
or \code{NULL} to inherit if present atribute 'deriv2'.}

\item{x}{Numeric vector of parameter values.}

\item{names}{Optional character vector of parameter names.}
}
\value{
An object of class \code{"parvec"}, i.e. a named numeric vector with
attributes:
\itemize{
\item \code{attr(x, "deriv")} — Jacobian matrix
\item \code{attr(x, "deriv2")} — Hessian tensor (if available)
}

A numeric vector of class \code{"parvec"} with optional attributes:
\itemize{
\item \code{attr(x, "deriv")}  — Jacobian matrix, or \code{NULL}
\item \code{attr(x, "deriv2")} — Hessian tensor, or \code{NULL}
}
}
\description{
A parameter vector is a named numeric vector (the parameter values)
together with derivative attributes describing how it was generated by
a parameter transformation.
The first derivative (Jacobian) is stored in the \code{"deriv"} attribute,
and, if available, the second derivative (Hessian) is stored in the \code{"deriv2"} attribute.

Creates an object of class \code{parvec}, optionally carrying first- and
second-order derivatives. No automatic identity or zero derivatives are
created.
}
\details{
If \code{deriv = FALSE} or \code{deriv2 = FALSE}, the respective attributes are
forcibly removed, even if they exist in the input \code{x}.
If \code{deriv = NULL} or \code{deriv2 = NULL}, existing attributes are inherited
(if present), but nothing is created automatically.
}
\examples{
\dontrun{
  ## ===============================================================
  ## Example: parvec class and derivative handling
  ## ===============================================================
  
  ## --- 1. Basic creation ------------------------------------------------------
  
  # create a simple parameter vector
  p <- as.parvec(c(a = 1, b = 2, c = 3))
  print(p)
  
  # extract the Jacobian (identity by default)
  getDerivs(p)
  
  # extract the Hessian (zero tensor by default)
  getDerivs2(p)
  
  
  ## --- 2. Custom derivatives --------------------------------------------------
  
  # create a Jacobian (deriv) and Hessian (deriv2) manually
  J <- matrix(c(1, 0, 0,
                0, 2, 0,
                0, 0, 3),
              nrow = 3, byrow = TRUE,
              dimnames = list(c("a", "b", "c"), c("x", "y", "z")))
  
  H <- array(0, dim = c(3, 3, 3),
             dimnames = list(c("a", "b", "c"),
                             c("x", "y", "z"),
                             c("x", "y", "z")))
  H["a","x","x"] <- 1
  H["b","y","y"] <- 2
  H["c","z","z"] <- 3
  
  # combine into a parvec
  p2 <- as.parvec(c(a = 10, b = 20, c = 30), deriv = J, deriv2 = H)
  
  # print summary
  print(p2)
  
  # extract first and second derivatives
  getDerivs(p2)
  getDerivs2(p2)
  
  
  ## --- 3. Subsetting ----------------------------------------------------------
  
  # select subset of parameters
  p_sub <- p2[c("a", "b")]
  print(p_sub)
  
  # confirm that Jacobian and Hessian were subset correctly
  getDerivs(p_sub)
  getDerivs2(p_sub)
  
  
  ## --- 4. Concatenation -------------------------------------------------------
  
  # combine multiple parvecs
  p3 <- as.parvec(c(d = 4, e = 5))
  p_combined <- c(p2, p3)
  
  print(p_combined)
  dim(getDerivs(p_combined))
  dim(getDerivs2(p_combined))
  
  
  ## --- 5. Consistency check ---------------------------------------------------
  
  stopifnot(
    all.equal(names(p_combined), c("a", "b", "c", "d", "e")),
    all(dim(getDerivs(p_combined))[1:2] == length(p_combined))
  )
  
  cat("\nAll checks passed.\n")
  
  ## --- END -------------------------------------------------------------------
}
}
