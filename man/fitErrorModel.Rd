% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/statistics.R
\name{fitErrorModel}
\alias{fitErrorModel}
\title{Fit an error model using maximum likelihood estimation}
\usage{
fitErrorModel(
  data,
  factors,
  errorModel = "exp(s0)+exp(srel)*x^2",
  par = c(s0 = 1, srel = 0.1),
  lower = NULL,
  upper = NULL,
  plotting = TRUE,
  blather = FALSE,
  ...
)
}
\arguments{
\item{data}{A data frame containing reduced replicate data. Must include 
columns "value" (mean of replicates), "sigma" (sample standard deviation), 
and "n" (number of replicates per condition).}

\item{factors}{Character vector specifying the columns in \option{data} 
that define pooling conditions. The model is fit separately for each unique 
combination of these factors.}

\item{errorModel}{A character string defining the error model in terms of 
variance. The mean is referenced as \kbd{x}, e.g., "exp(s0) + exp(srel) * x^2".}

\item{par}{Named numeric vector of initial values for the parameters in 
\option{errorModel}.}

\item{lower}{Optional named numeric vector specifying lower bounds for 
parameters. Defaults to \code{NULL} (no bounds).}

\item{upper}{Optional named numeric vector specifying upper bounds for 
parameters. Defaults to \code{NULL} (no bounds).}

\item{plotting}{Logical. If \code{TRUE}, a plot of the pooled variance and 
the fitted error model is displayed.}

\item{blather}{Logical. If \code{TRUE}, additional information is returned, 
including fitted parameter values, original \code{sigma} values, and confidence intervals.}

\item{...}{Additional arguments passed to the optimizer \code{\link[optimx]{optimr}}.}
}
\value{
By default, a data frame is returned, containing the original data 
  with updated \code{sigma} values estimated from the error model.

  If \option{blather = TRUE}, additional information is returned, including:
  - The fitted parameter values.
  - The error model used.
  - Confidence intervals for \code{sigma} at 68\% and 95\% levels.
  - Effective pooling conditions.
}
\description{
Fit an error model to reduced replicate data using maximum 
likelihood estimation (MLE). The model estimates the variance of replicate 
measurements as a function of the mean, based on a chi-square distribution.
}
\details{
The model assumes that the sample variance of replicate measurements 
  follows a chi-square distribution with \eqn{n-1} degrees of freedom. The 
  variance is estimated by maximizing the log-likelihood function derived 
  from this distribution. Given multiple replicates, the variance can be 
  modeled as a function of the mean.

  The \option{errorModel} parameter defines this functional relationship. 
  It should be expressed as a character string, using \kbd{x} to represent 
  the mean.

  The optimization is performed using \code{\link[optimx]{optimr}} with the 
  \code{"L-BFGS-B"} method, which supports bound constraints. If \option{lower} 
  and \option{upper} are not specified, the parameters are assumed to be 
  unconstrained.

  If \option{plotting = TRUE}, the function produces a log-scale variance 
  plot for each condition, showing the pooled variance, the fitted model, 
  and 68\% and 95\% confidence bounds.
}
\author{
Wolfgang Mader, \email{Wolfgang.Mader@fdm.uni-freiburg.de}

Simon Beyer, \email{simon.beyer@fdm.uni-freiburg.de}
}
